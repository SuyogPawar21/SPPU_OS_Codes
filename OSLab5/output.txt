#include <stdio.h>
#include <stdbool.h>

#define MAXPROCESSES 10

struct Resources {
    int A;
    int B;
    int C;
};

int processesCount = 5;
struct Resources allocations[MAXPROCESSES];
struct Resources max[MAXPROCESSES];
struct Resources available;
struct Resources need[MAXPROCESSES];
int executionSequence[MAXPROCESSES];

void calculateNeed() {
    for (int i = 0 ; i < processesCount; i++) {
        need[i].A = max[i].A - allocations[i].A;
        need[i].B = max[i].B - allocations[i].B;
        need[i].C = max[i].C - allocations[i].C;
    }
}

bool canBeFulfilled(int processIndex) {
    return (need[processIndex].A <= available.A) &&
           (need[processIndex].B <= available.B) && (need[processIndex].C <= available.C);
}

void fulfillRequest(int processIndex) {
    available.A += allocations[processIndex].A;
    available.B += allocations[processIndex].B;
    available.C += allocations[processIndex].C;
}

void printAvailableResources() {
    printf("Available Resources: A-%i, B-%i, C-%i\n", available.A, available.B, available.C);
}

void BankersAlgo() {

    calculateNeed();

    int processesRemaining[MAXPROCESSES];
    int processesRemainingCount = processesCount;

    for (int i = 0; i < processesCount; i++) {
        processesRemaining[i] = 1;
    }

    while (processesRemainingCount > 0) {
        for (int i = 0; i < processesCount; i++) {
            if (processesRemaining[i] == 1) {
                if (canBeFulfilled(i) == true) {
                    fulfillRequest(i);
                    printf("\n%ith Process Executed\n", i);
                    printAvailableResources();
                    executionSequence[processesCount - processesRemainingCount] = i;
                    processesRemainingCount--;
                    processesRemaining[i] = 0;
                }
            }
        }
    }

}

void printExecutionSequence() {
    printf("\nStart->");
    for (int i = 0; i < processesCount; i++) {
        printf("P%i->", executionSequence[i]);
    }
    printf("End");
}

void input() {
    printf("Enter number of Processes: ");
    scanf("%i", &processesCount);

    for (int i = 0; i < processesCount; i++) {

        printf("Enter number of allocations of resource of type A for %i Process: ", i);
        scanf("%i", &allocations[i].A);

        printf("Enter number of allocations of resource of type B for %i Process: ", i);
        scanf("%i", &allocations[i].B);

        printf("Enter number of allocations of resource of type C for %i Process: ", i);
        scanf("%i", &allocations[i].C);

    }

    for (int i = 0; i < processesCount; i++) {

        printf("Enter number of resources required of type A for %i Process: ", i);
        scanf("%i", &max[i].A);

        printf("Enter number of resources required of type B for %i Process: ", i);
        scanf("%i", &max[i].B);

        printf("Enter number of resources required of type C for %i Process: ", i);
        scanf("%i", &max[i].C);

    }

    printf("Enter number of resources available of type A: ");
    scanf("%i", &available.A);

    printf("Enter number of resources available of type B: ");
    scanf("%i", &available.B);

    printf("Enter number of resources available of type C: ");
    scanf("%i", &available.C);

}

int main() {
    input();
    BankersAlgo();
    printExecutionSequence();
    return 0;
}


Enter number of Processes: 5
Enter number of allocations of resource of type A for 0 Process: 1
Enter number of allocations of resource of type B for 0 Process: 1
Enter number of allocations of resource of type C for 0 Process: 2
Enter number of allocations of resource of type A for 1 Process: 2
Enter number of allocations of resource of type B for 1 Process: 1
Enter number of allocations of resource of type C for 1 Process: 2
Enter number of allocations of resource of type A for 2 Process: 3
Enter number of allocations of resource of type B for 2 Process: 0
Enter number of allocations of resource of type C for 2 Process: 1
Enter number of allocations of resource of type A for 3 Process: 0
Enter number of allocations of resource of type B for 3 Process: 2
Enter number of allocations of resource of type C for 3 Process: 0
Enter number of allocations of resource of type A for 4 Process: 1
Enter number of allocations of resource of type B for 4 Process: 1
Enter number of allocations of resource of type C for 4 Process: 1
Enter number of resources required of type A for 0 Process: 5
Enter number of resources required of type B for 0 Process: 4
Enter number of resources required of type C for 0 Process: 4
Enter number of resources required of type A for 1 Process: 4
Enter number of resources required of type B for 1 Process: 3
Enter number of resources required of type C for 1 Process: 3
Enter number of resources required of type A for 2 Process: 9
Enter number of resources required of type B for 2 Process: 1
Enter number of resources required of type C for 2 Process: 3
Enter number of resources required of type A for 3 Process: 8
Enter number of resources required of type B for 3 Process: 6
Enter number of resources required of type C for 3 Process: 4
Enter number of resources required of type A for 4 Process: 2
Enter number of resources required of type B for 4 Process: 2
Enter number of resources required of type C for 4 Process: 3
Enter number of resources available of type A: 3
Enter number of resources available of type B: 2
Enter number of resources available of type C: 1

1th Process Executed
Available Resources: A-5, B-3, C-3

4th Process Executed
Available Resources: A-6, B-4, C-4

0th Process Executed
Available Resources: A-7, B-5, C-6

2th Process Executed
Available Resources: A-10, B-5, C-7

3th Process Executed
Available Resources: A-10, B-7, C-7

Start->P1->P4->P0->P2->P3->End
Process finished with exit code 0
